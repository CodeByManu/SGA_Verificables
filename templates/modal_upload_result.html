<div id="upload-result-modal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
    <div class="absolute inset-0 bg-black opacity-50" onclick="closeUploadResultModal()"></div>
    
    <div class="bg-white p-6 rounded-lg shadow-lg z-10 max-w-md w-full text-center">
        <h2 id="upload-result-title" class="text-xl font-semibold text-gray-800 mb-4">
            Carga completada
        </h2>
        <p id="upload-result-message" class="text-gray-600">Los datos fueron procesados exitosamente.</p>

        <div class="mt-6">

        </div>
    </div>
</div>

{% block scripts %} 
<script>
function showUploadResult(success = true, message = '') {
    const modal = document.getElementById('upload-result-modal');
    const title = document.getElementById('upload-result-title');
    const msg = document.getElementById('upload-result-message');

    title.textContent = success ? "Carga exitosa" : "Error en la carga";
    msg.textContent = message || (success 
        ? "Los datos fueron procesados correctamente." 
        : "Ocurri√≥ un problema al procesar el archivo JSON.");

    modal.classList.remove('hidden');
}

function closeUploadResultModal() {
    document.getElementById('upload-result-modal').classList.add('hidden');
}
</script>

<script>

function handleJsonUpload(input, endpointUrl) {
    const file = input.files[0];
    if (!file) return;

    const formData = new FormData();
    formData.append('json_file', file);

    fetch(endpointUrl, {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        const tipo = endpointUrl.includes("teacher") ? "profesores" :
                     endpointUrl.includes("student") ? "estudiantes" :
                     "datos";
        if (data.success) {
            showUploadResult(true, `${data.message}`);
            setTimeout(() => location.reload(), 2000);
        } else {
            showUploadResult(false, `${tipo}: ${data.message}`);
        }
    })
    .catch(() => {
        showUploadResult(false, "Error de red o de servidor.");
    });
}


    </script>
    
{% endblock %}